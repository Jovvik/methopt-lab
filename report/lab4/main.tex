\input{settings}

\begin{document}



\begin{titlepage}
	\begin{center}
		\textsc{Национальный исследовательский университет ИТМО\\
			Прикладная математика и информатика}\\[5cm]

		\huge{Методы оптимизации\\[6mm]
			\large Отчет по лабораторной работе №4\\
			``Изучение алгоритмов метода Ньютона и его модификаций, в том числе
			квазиньютоновских методов''\\[4cm]

		}
	\end{center}

	\begin{flushright}
		\begin{minipage}{0.25\textwidth}
			Выполнили:\\[2mm]
			Михайлов Максим\\
			Загребина Мария\\
			Кулагин Ярослав\\[2mm]
			Команда:

			\(\forall \bar R \in \mathscr{R}^n : \mathrm{\textbf{R}}(\bar R) \in \mathscr{R}\)

			(КаМаЗ)\\[2mm]
			Группа: M3237
		\end{minipage}
	\end{flushright}

	\vfill
	\begin{center}
		Санкт-Петербург, \today
	\end{center}
\end{titlepage}





\section{Цель}
\begin{enumerate}
	\item Разработать программы для безусловной минимизации функций
	многих переменных
	\item Реализовать метод Ньютона
		\begin{itemize}
			\item классический
			\item с одномерным поиском
			\item с направлением спуска
		\end{itemize}
	\item Продемонстрировать работу методов на 2-3 функциях, исследовать влияние выбора начального приближения на результат
	\item Исследовать работу методов на двух функциях с заданным начальным приближением
		\begin{itemize}
			\item \(f(x) = x_1^2 + x_2^2 - 1.2x_1x_2,\ x^0 = (4, 1)^T\)
			\item \(f(x) = 100(x_2 - x_1^2)^2 + (1 - x_1)^2,\ x^0 = (-1.2, 1)^T\)	
		\end{itemize}
	\item Реализовать метод Давидона-Флетчера-Пауэлла и метод Пауэлла и сравнить с наилучшим методом Ньютона
\end{enumerate}

\section{Ход работы}

На всех иллюстрациях обозначены цвета:\\
Классический метод - зеленый\\
Метод Ньютона с одномерным поиском - голубой\\
Метод Ньютона с направлением спуска - оранжевый

Во всех измерениях для одномерного поиска использовался метод Брента.

\subsection{Метод Ньютона}

\(\varepsilon = 10^(-5)\)\\
Начальная точка $(0.1, 0,1)$
\(f_1 = 108x^2 + 116y^2 + 80xy + 43x + 33y - 211\)\\
\img{img/f1.png}

\(f_2 = sin(x) + cos(y) + 0.3y^2+ 0.3x^2 + 0.1y\)
\img{img/sincos.png}

Классический метод Ньютона\\
\itertable{data/task1/classic.txt}

Метод Ньютона с одномерным поиском\\
\itertable{data/task1/search.txt}

Метод Ньютона с направлением спуска\\
\itertable{data/task1/descent.txt} 


Классический метод Ньютона не всегда находит точку минимума на сложных функциях.
Выбор начального приближения влияет на количество итераций методов.
Так как матрица Гессе квадратичной функции положительно определена, все методы сходятся за одну итерацию и накладываются на графике.

\subsection{Исследование на заданных функциях}
\(f_1 = x_1^2 + x_2^2 - 1.2x_1x_2,\ x^0 = (4, 1)^T\) \\
\img{img/f2_1.png}

\(f_2 = 100(x_2 - x_1^2)^2 + (1 - x_1)^2,\ x^0 = (-1.2, 1)^T\)	
\img{img/f2_2.png}

\methodtable{data/task1_2/all.txt} 

По результатам измерений на данных функциях наилучший метод Ньютона - классический. Все методы работают гораздо медленнее на овражной функции $f_2$. По сравнению с наискорейшим спуском из 2-ой лабораторной работы, методы используют меньшее число итераций, и не так сильно зависят от числа обусловленности.

\subsection{Квазиньютоновские методы}
Начальная точка $(-1.2, 1)$
\(f_1 = 100(x_2 - x_1^2)^2 + (1 - x_1)^2,\)\\
\img{img/f2_2_1.png}

\(f_2 = (x_1^2 + x_2 - 11)^2 + (x_1 + x_2^2 - 7)^2)\)\\
\img{img/f2_2_2.png}

\(f_3 = (x_1 + 10x_2)^2 + 5(x_3 - x_4)^2 + (x_2 - 2x_3)^4 + 10(x_1 - x_4)^4\)\\

\(f_4 = 100 - \frac{2}{1 + (\frac{x_1 - 1}{2})^2 + (\frac{x_2 - 1}{3})^2} - \frac{1}{1 + (\frac{x_1 - 2}{2})^2 + (\frac{x_2 - 1}{3})^2}\)\\
\img{img/f2_2_4.png}

Классический метод Ньютона\\
\itertable{data/task3/classic.txt}

Метод Давидона-Флетчера-Пауэлла\\
\itertable{data/task3/dfp.txt}

Метод Пауэлла\\
\itertable{data/task3/powell.txt}

\section{Выводы}

\begin{enumerate}
	\item Классический метод Ньютона работает быстро, но сходится не на всх функциях, так как в нем не оптимизации по выбору $\alpha$. Остальные методы Ньютона более надежные и показали очень похожий результат.
	\item Выбор начального приближения, как и число обусловденности, влият на количество итераций методов.
	\item Методы ДФП и Пауэлла работают примерно с одинаковой скоростью и находят значения с заданной точностью на всех функциях, в отличие от классического метода, который был ограничен количеством итераций.
\end{enumerate}


\section{Исходный код}

\mcode{Функция}{../../include/lab4/n_function_impl.h}
\mcode{Функция}{../../source/lab4/n_function_impl.cpp}

\mcode{Классический метод Ньютона}{../../include/lab4/classic_newton.h}
\mcode{Классический метод Ньютона}{../../source/lab4/classic_newton.cpp}

\mcode{метод Давидона-Флетчера-Пауэлла}{../../include/lab4/dfp.h}
\mcode{метод Давидона-Флетчера-Пауэлла}{../../source/lab4/dfp.cpp}

%\mcode{Метод Ньютона с одномерным поиском}{../../include/lab4/1d_search_newton.h}
%\mcode{Метод Ньютона с одномерным поиском}{../../source/lab4/1d_search_newton.cpp}

\mcode{Метод Ньютона с направлением спуска}{../../include/lab4/dfp.h}
\mcode{Метод Ньютона с направлением спуска}{../../source/lab4/dfp.cpp}

\mcode{Метод Пауэлла}{../../include/lab4/powell.h}
\mcode{Метод Пауэлла}{../../source/lab4/powell.cpp}
\end{document}
