\input{settings}

\begin{document}



\begin{titlepage}
    \begin{center}
        \textsc{Национальный исследовательский университет ИТМО\\
            Прикладная математика и информатика}\\[5cm]

        \huge{Методы оптимизации\\[6mm]
            \large Отчет по лабораторной работе №1\\
            ``Алгоритмы одномерной минимизации функции''\\[6mm]
            Вариант 1
            \\[3cm]
        }
    \end{center}

    \begin{flushright}
        \begin{minipage}{0.25\textwidth}
            Выполнили:\\[2mm]
            Михайлов Максим\\
            Загребина Мария\\
            Кулагин Ярослав\\[2mm]
            Группа M3237
        \end{minipage}
    \end{flushright}

    \vfill
    \begin{center}
        Санкт-Петербург, \today
    \end{center}
\end{titlepage}





\section{Цель}
Реализовать алгоритмы одномерной минимизации функции:
\begin{itemize}
    \item Метод дихотомии
    \item Метод золотого сечения
    \item Метод Фибоначчи
    \item Метод парабол
    \item Комбинированный метод Брента
\end{itemize}
Протестировать алгоритмы на \(f(x) = x^2 + e^{-0.35x}\) в интервале \([-2; 3]\) и других функциях, сравнить методы друг с другом.




\section{Ход работы}

\subsection{Аналитическое решение}

\begin{multicols}{2}
    \begin{align*}
        0 = f'(x)        & = 2x - 0.35 e^{ - 0.35x}                          \\
        2x               & = 0.35 e^{ - 0.35x}                               \\
        800 \cdot 0.35 x & = 49 \frac{1}{e^{0.35 x}}                         \\
        0.35 x : = W(z)                                                      \\
        800 \cdot W(z)   & = 49 \frac{W(z)}{z}                               \\
        \frac{49}{800}   & = z                                               \\
        0.35 x           & = W\left(\frac{800}{49}\right)                    \\
        x                & = \frac{20}{7} \cdot W\left(\frac{800}{49}\right)
    \end{align*}

    \(W\)-функция Ламберта не может быть выражена в элементарных функциях, поэтому аналитическое решение приближенное:

    \[\begin{cases}
            x_{\min} \approx 0.16517 \\
            y_{\min} \approx 0.9711  \\
        \end{cases}\]
    \columnbreak

    \begin{tikzpicture}
        \begin{axis}[
                title = \(x^2 + e^{-0.35x}\),
                xmin = -2,
                xmax = 3,
            ]
            \addplot[blue, samples=50] {x^2 + e^(-0.35*x)};
        \end{axis}
    \end{tikzpicture}
\end{multicols}



\subsection{Метод дихотомии}

\stats{data/dichotomy.csv}\\[2mm]
\graph{data/dichotomy2.csv}

\subsection{Метод золотого сечения}

\stats{data/goldenRatio.csv}\\[2mm]
\graph{data/goldenRatio2.csv}

\subsection{Метод Фибоначчи}

\stats{data/fibonacci.csv}\\[2mm]
\graph{data/fibonacci2.csv}


\subsection{Метод парабол}

\stats{data/parabola.csv}\\[2mm]
\graph{data/parabola2.csv}

\subsection{Комбинированный метод Брента}
\pgfplotstabletypeset[
	every even row/.style=
	{before row={\rowcolor[gray]{0.95}}},
	string type,
	columns/number/.style={column name=$N$, column type={|l}},
	columns/a/.style={column name=$a$, column type={|c}},
	columns/b/.style={column name=$b$, column type={|c|}},
	columns/length/.style={column name=\makecell[b]{\% длины\\предыдущего\\отрезка}, column type={c|}},
	columns/u/.style={column name=$u$, column type={c|}},
	columns/w/.style={column name=$w$, column type={c|}},
	columns/x/.style={column name=$x$, column type={c|}},
	columns/v/.style={column name=$v$, column type={c|}},
	columns/fu/.style={column name=$f(u)$, column type={c|}},
	columns/fw/.style={column name=$f(w)$, column type={c|}},
	columns/fx/.style={column name=$f(x)$, column type={c|}},
	columns/fv/.style={column name=$f(v)$, column type={c|}},
	every head row/.style={before row=\hline, after row=\hline},
	every last row/.style={after row=\hline},
	]{data/brent.csv}	

\graph{data/brent2.csv}

\section{Тестирование на многомодальных функциях}

\subsection{\(f(x) = sin(x)*x\)}
    \begin{tikzpicture}
	\begin{axis}[
		xmin = -5,
		xmax = 5,
		]
	\addplot[blue, samples=50] {sin(deg(x))*x};
\end{axis}
\end{tikzpicture}

\begin{tabular}{ | l | l | l | }
	\hline
	 & \(f(x) = sin(x)*x\) & \\ \hline
	Верный ответ  & 4.91318 &  \\ \hline
	Дихотомия & 2.2594e-16 &\\ \hline
	Золотое сечение & 2.80886e-16 &  \\ \hline
	Фибоначчи & 2.2594e-16 & \\ \hline
	Параболы & 4.91318 &  \\ \hline
	Метод Брента & 4.91318 & \\ \hline
\end{tabular}

\section{Выводы}
Для каждого метода $\varepsilon = 10^{-6}$\\


\newpage
\section{Код}

\subsection{Рассматриваемый отрезок}
\mcode{../include/lab/segment.h}
\mcode{../source/segment.cpp}

\subsection{Общий класс оптимизаторов}
\mcode{../include/lab/optimizer.h}
\mcode{../source/optimizer.cpp}
\newpage

\subsection{Общий класс оптимизаторов, рассматривающих 2 точки}
\mcode{../include/lab/two_point.h}
\mcode{../source/two_point.cpp}
\newpage

\subsection{Метод Дихотомии}
\mcode{../include/lab/dichotomy.h}
\mcode{../source/dichotomy.cpp}
\newpage

\subsection{Метод золотого сечения}
\mcode{../include/lab/golden_ratio.h}
\mcode{../source/golden_ratio.cpp}
\newpage

\subsection{Метод Фибоначчи}
\mcode{../include/lab/fibonacci.h}
\mcode{../source/fibonacci.cpp}
\newpage

\subsection{Метод парабол}
\mcode{../include/lab/parabola.h}
\mcode{../source/parabola.cpp}

\subsection{Комбинированный метод Брента}
\mcode{../include/lab/brent.h}
\mcode{../source/brent.cpp}

\end{document}

