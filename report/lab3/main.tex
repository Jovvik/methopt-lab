\input{settings}

\begin{document}



\begin{titlepage}
	\begin{center}
		\textsc{Национальный исследовательский университет ИТМО\\
			Прикладная математика и информатика}\\[5cm]

		\huge{Методы оптимизации\\[6mm]
			\large Отчет по лабораторной работе №3\\
			``Решение СЛАУ''\\[4cm]

		}
	\end{center}

	\begin{flushright}
		\begin{minipage}{0.25\textwidth}
			Выполнили:\\[2mm]
			Михайлов Максим\\
			Загребина Мария\\
			Кулагин Ярослав\\[2mm]
			Команда:

			\(\forall \bar R \in \mathscr{R}^n : \mathrm{\textbf{R}}(\bar R) \in \mathscr{R}\)

			(КаМаЗ)\\[2mm]
			Группа: M3237
		\end{minipage}
	\end{flushright}

	\vfill
	\begin{center}
		Санкт-Петербург, \today
	\end{center}
\end{titlepage}





\section{Цель}
\begin{enumerate}
	\item Реализовать прямой метод решения СЛАУ на основе LU-разложения
	\item Оценить влияние увеличения числа обусловленности на
	      точность решения
	\item Провести исследования на матрицах Гильберта различной
	      размерности
	\item Реализовать метод Гаусса с выбором ведущего элемента для плотных
	      матриц и сравнить с прямым методом
	\item Реализовать метод сопряженных градиентов, провести измерения на различных матрицах
\end{enumerate}
\section{Ход работы}

\subsection{Прямой метод решения СЛАУ на основе LU-разложения}
\begin{itemize}
	\item $LU$-разложение:\\

	      \(L_{11} = A_{11}\)\\

	      \(\forall i = 2..n\)\\
	      \[L_{ij} = A_{ij} - \sum_{k=1}^{j-1} L_{ik} \cdot U_{kj};\ j = \overline{1, j-1}\]
	      \[L_{ii} = A_{ii} - \sum_{k=1}^{j-1}  L_{ik} \cdot U_{ki}\]

	      \[U_{ji} = \frac{1}{L_{jj}} \cdot \left[A_{ij} - \sum_{k=1}^{j-1} L_{jk} \cdot U_{ki} \right];\ j = \overline{1, i-1}\]
	      \[U_{ii} = 1\]

	\item Алгоритм:
	      \begin{enumerate}
		      \item Разложить $A$ на $L, U$
		      \item Решить $Ly = b$ прямым ходом метода Гаусса
		      \item Решить $Ux = y$ обратным ходом метода Гаусса
	      \end{enumerate}


	\item Алгоритм метода Гаусса:
	      \begin{enumerate}
		      \item Прямой ход
		            \[a_{ij}^{(k)} = a_{ij}^{(k-1)} - \frac{a_{ik}^{(k-1)}}{a_{kk}^{(k-1)}} \cdot a_{kj}^{(k-1)}\]
		            \[b_j^{(k)} = b_j^{(k-1)} - \frac{a_{ik}^{(k-1)}}{a_{kk}^{(k-1)}} \cdot b_k^{(k-1)}\]
		            где $k$ - номер этапа: $\overline{1, n-1}$\\
		            $i,j \in \overline{k + 1, n}$
		      \item Обратный ход
		            \[x_k = \frac{1}{a_{kk}^{(k-1)}} \left[ b_k^{(k-1)} - \sum_{j=k+1}^{n} a_{kj}^{(k-1)} \cdot x_j \right]\]
		            $k \in \overline{n, 1}$
	      \end{enumerate}

	\item Общий вид генерируемых матриц:

	      \[a_{ii} =
		      \begin{cases}
			      -\sum_{i\neq j} a_{ij}, \ i > 1 \\
			      -\sum_{i\neq j} a_{ij} + 10^{-k}, \ i = 1
		      \end{cases}\]

	      \(a_{ij}\) выбирается случайно из \(\{0, -1, -2, -3, -4\}\)
\end{itemize}
\nktable{data/task2/n10.csv}{$n = 10$}

\nktable{data/task2/n100.csv}{$n = 100$}

\nktable{data/task2/n500.csv}{$n = 500$}

\nktable{data/task2/n1000.csv}{$n = 1000$}

\fullgraph{10}{100}{500}{1000}

При увеличении $k$ растет число обусловленности и экспоненциально уменьшается получаемая точность.
При $k \geq 15$ погрешность перестает изменяться для всех рассмотренных размерностей и становится максимальной, т.к. точность ЭВМ не позволяет выразить различия между рассматриваемыми матрицами.

По результатам измерений при $k = 10$ вычитание
\(a_{ij}^{(k-1)} - \frac{a_{ik}^{(k-1)}}{a_{kk}^{(k-1)}} \cdot a_{kj}^{(k-1)}\)
близких друг к другу элементов вызывает скачкообразное накопление погрешности.

\subsection{Исследования на матрицах Гильберта}

Общий вид матрицы:
\[a_{ij} = \frac{1}{i + j - 1},\  i, j \in \overline{1, k}\]
\ntable{data/task3/hilbert.csv}

\graph{data/task3/hilbert.csv}


\section{Метод Гаусса с выбором ведущего элемента для плотных матриц}

Необходимо найти \(m \geq k\), где \(k\) --- номер рассматриваемого шага, а \(|a_{mk}| = \max_{i \geq k} \{|a_{ik}|\} \).

\begin{itemize}
	\item Если \(a_{mk} = 0 (\approx \varepsilon)\), однозначного решения нет, остановка алгоритма.
	\item Если \(a_{mk} \neq 0\), меняем местами \(b_k\) и \(b_m\); \(a_{kj}\) и \(a_{mj}\) при \(j = k \dots n\).
\end{itemize}

\ntable{data/task4/dense.csv}{Метод Гаусса}
\hfill
\ntable{data/task4/lu.csv}{Прямой метод LU-разложения}

\densegraph{data/task4/dense.csv}{data/task4/lu.csv}
Два графика наложились друг на друга из-за близких значений погрешности.

\section{Метод сопряженных градиентов}
Точность решения СЛАУ $10^{-7}$

\subsection{Матрица с диагональным преобладанием}
Общий вид матрицы:
\[a_{ii} =
	\begin{cases}
		-\sum_{i\neq j} a_{ij}, \ i > 1 \\
		-\sum_{i\neq j} a_{ij} + 1, \ i = 1
	\end{cases}\]

\ntable{data/task5/msg.csv}

\subsection{Матрица с обратным знаком внедиагональных элементов}
\ntable{data/task5/msg_rev.csv}


\subsection{Матрица Гильберта}
\ntable{data/task5/msg_hilbert.csv}

\loggraph{data/task5/msg.csv}{data/task5/msg_rev.csv}{data/task5/msg_hilbert.csv}

\subsubsection*{Матрица Гильберта}

Искомая точность не достигается, т.к. МСГ использует невязку как критерий останова, и искомая невязка достигается. Вследствие этого выполняется малое число итераций.

\subsubsection*{Прочие матрицы}

Точность полученного решения задается параметром $\varepsilon$, поэтому во всех измерениях, независимо от размерности и типа, наблюдается почти одинаковое значение погрешности.\\
Знак внедиагональных элементов для сгенерированных матриц не влияет на количество итераций.\\
Количество итераций линейно зависит от размерности матрицы.

\newpage
\section{Выводы}

\begin{enumerate}
	\item Реализованы следующие алгоритмы решения СЛАУ:
	      \begin{itemize}
		      \item Метод Гаусса для LU-разложения для профильных матриц
		      \item Метод Гаусса с выбором ведущего элемента для плотных матриц
		      \item Метод сопряженных градиентов для симметричных матриц
	      \end{itemize}

	\item Для метода Гаусса с LU-разложением была установлена зависимость точности алгоритма от размерности матрицы и линейная зависимость от числа обусловленности.
	\item Для плохо обусловленных матриц Гильберта методы Гаусса дают ответ, отличающийся от правильного не больше, чем на $10^{7}$
	\item Метод Гаусса с LU-разложением и метод Гаусса с выбором ведущего элемента показали одинаковую точность, но LU разложение потребовало больше действий.
	\item Метод сопряженных градиентов считает ответ с небольшой погрешностью, но работает долго на больших размерностях. Для матриц Гильберта метод сопряженных градиентов не достигает искомой точности.
\end{enumerate}

\section{Исходный код}

\mcode{Вектор}{Vector.java}

\mcode{Общий класс матриц}{Matrix.java}

\mcode{Профильная матрица}{ProfileMatrix.java}

\mcode{Плотная матрица}{DenseMatrix.java}

\mcode{Разреженная матрица}{SparseMatrix.java}

\mcode{LU-разложение матрицы}{LUDecomposition.java}

\mcode{Генератор матриц}{Generator.java}

\mcode{Генератор профильных матриц}{ProfileMatrixGenerator.java}

\mcode{Генератор разреженных матриц}{SparseMatrixGenerator.java}

\mcode{Утилиты}{Utils.java}


\end{document}
